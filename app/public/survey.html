<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Friend Finder</title>
  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="../../semantic/dist/semantic.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.0.1/js/all.js"></script>
  <script src="../../semantic/dist/semantic.min.js"></script>
</head>

<body>

  <div class="ui inverted vertical masthead segment">
    <div class="ui left aligned text container">
      <h1 class="ui purple inverted header huge">
        <i class="fas fa-clipboard"></i> Survey Questions
      </h1>
      <form class="ui form inverted" id="survey_form">

        <div class="field">
          <h2 class="ui yellow inverted huge header">Name (Required)</h2>
          <input type="text" name="user_name">
        </div>

        <div class="field">
          <h2 class="ui yellow inverted huge header">Link to Photo Image (Required)</h2>
          <input type="text" name="user_url">
        </div>

        <div class="ui horizontal divider inverted">
          Question Time! Don't Think to Hard Just Answer Honestly
        </div>

        <div class="field">
          <h3 class="ui red inverted header">Question 1: Peace is a lie.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q1">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>
        <div class="field">
          <h3 class="ui blue inverted header">Question 2: There are no emotions, only peace.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q2">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui red inverted header">Question 3: The only way to have power is to gain strength.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q3">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui blue inverted header">Question 4: With enough knowledge you can overcome ignorance.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q4">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui red inverted header">Question 5: Fulfilling your passions are the only way to true strength.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q5">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui blue inverted header">Question 6: Forgoing your passions brings serenity.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q6">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui red inverted header">Question 7: Only victors have true freedom.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q7">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui blue inverted header">Question 8: Harmony is the real goal of life.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q8">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui red inverted header">Question 9: The Force is meant to free you.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q9">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>

        <div class="field">
          <h3 class="ui blue inverted header">Question 10: There is no such thing as death, only Force.</h3>
          <div class="ui selection dropdown">
            <input type="hidden" name="q10">
            <i class="dropdown icon"></i>
            <div class="default text">Select An Option</div>
            <div class="menu">
              <div class="item" data-value="1">1 - Strongly Disagree</div>
              <div class="item" data-value="2">2 - Disagree</div>
              <div class="item" data-value="3">3 - I Don't Know</div>
              <div class="item" data-value="4">4 - Agree</div>
              <div class="item" data-value="5">5 - Strongly Agree</div>
            </div>
          </div>
        </div>
        <div class="field">
          <button class="ui button" type="submit">Submit</button>
          <div class="ui error message"></div>
        </div>

      </form>
    </div>
  </div>
  <div class="ui segment">
    <div class="ui text container">
      <a href="/">Home</a> | 
      <a href="/api/friends">API Friends List</a> |
      <a href="https://github.com/MarQG/FriendFinder" target="_blank">GitHub Repo</a>
    </div>
  </div>

  <div class="ui modal" id="modal-match">
    <div class="ui icon header">
      <i class="user icon"></i>
      Your Match
      <h2 id="modal-match-friend-name">Ferenc Gutierrez</h2>
    </div>
    <div class="image content">
      <img class="image" id="modal-match-friend-img">
      
    </div>
    <div class="actions">
        <div class="ui green ok inverted button">
            Okay
          </div>
    </div>
  </div>
  <script>

    $("document").ready(function () {

    $('.dropdown').dropdown();

    $('.ui.form').form({
        fields: {
          user_name: {
            identifier: 'user_name',
            rules: [{
              type: 'empty',
              prompt: 'Please enter your name'
            }]
          },
          user_url: {
            identifier: 'user_url',
            rules: [{
              type: 'url',
              prompt: 'Please enter a valid image link'
            }]
          },
          q1: {
            identifier  : 'q1',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q2: {
            identifier  : 'q2',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q3: {
            identifier  : 'q3',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q4: {
            identifier  : 'q4',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q5: {
            identifier  : 'q5',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q6: {
            identifier  : 'q6',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q7: {
            identifier  : 'q7',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q8: {
            identifier  : 'q8',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q9: {
            identifier  : 'q9',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          },
          q10: {
            identifier  : 'q10',
            rules: [
              {
                type   : 'empty',
                prompt : 'Please select a dropdown value'
              }
            ]
          }
        },
        onSuccess: function(event){
          event.preventDefault();
          var userInputs = $("#survey_form :input");


          var userAnswers = [];
          userInputs.slice(2, -1).each(function () {
            userAnswers.push(parseInt($(this).val()));

          });
          var newUser = {
            name: userInputs[0].value,
            photo: userInputs[1].value,
            scores: userAnswers
          };

          $.post('/api/friends', newUser, function(data){
            if(data){
              $("#modal-match-friend-name").text(data.name);
              $("#modal-match-friend-img").attr("src", data.photo);
              setTimeout(showModal, 300);
            }
          });

          
          function showModal(){
            $("#modal-match").modal({ observeChanges: true});
            $("#modal-match").modal("show");  
            $("#modal-match").modal("refresh");   
            $("#modal-match").modal("refresh");
            userInputs[0].value = "";
            userInputs[1].value = "";
            $('.dropdown').dropdown("restore defaults");
          }
        }
      });

    });
  </script>

</html>
